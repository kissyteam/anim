modulex.add("anim/timer",["dom","util","anim/base","anim/timer/easing","anim/timer/manager","anim/timer/fx","anim/timer/color","anim/timer/transform","anim/timer/short-hand"],function(t,r,e){function n(t,r,e,a,o){var i=this;return i instanceof n?(n.superclass.constructor.apply(i,arguments),void 0):new n(t,r,e,a,o)}var a=t("dom"),o=t("util"),i=t("./base"),s=t("./timer/easing"),u=t("./timer/manager"),l=t("./timer/fx");t("./timer/color"),t("./timer/transform");var c=t("./timer/short-hand"),f=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i;o.extend(n,i,{prepareFx:function(){var t=this,r=t.node,e=t._propsData;o.each(e,function(t){t.duration*=1e3,t.delay*=1e3,"string"==typeof t.easing&&(t.easing=s.toFn(t.easing))}),o.each(c,function(t,n){var i,s,u=e[n];u&&(s=u.value,i={},o.each(t,function(t){i[t]=a.css(r,t)}),a.css(r,n,s),o.each(i,function(t,n){n in e||(e[n]=o.merge(u,{value:a.css(r,n)})),a.css(r,n,t)}),delete e[n])});var n,i,u,m,d,p,h,v,g,b=0;o.isPlainObject(r)&&(b=1);for(n in e){if(i=e[n],u=i.value,p={isCustomFx:b,prop:n,anim:t,fxType:i.fxType,type:i.type,propData:i},h=l.getFx(p),m=u,d=h.cur(),u+="",v="",g=u.match(f)){if(m=parseFloat(g[2]),v=g[3],v&&"px"!==v&&d){var x=0,k=m;do++k,a.css(r,n,k+v),x=h.cur();while(0===x);d=k/x*d,a.css(r,n,d+v)}g[1]&&(m=("-="===g[1]?-1:1)*m+d)}p.from=d,p.to=m,p.unit=v,h.load(p),i.fx=h}},frame:function(){var t,r,e,n=this,a=1,i=n._propsData;for(t in i){if(e=i[t],r=e.fx,r.frame(),n.isRejected()||n.isResolved())return;a&=1===r.pos}var s=o.now(),u=1e3*n.config.duration,l=Math.max(0,n.startTime+u-s),c=l/u||0,f=1-c;n.defer.notify([n,f,l]),a&&n.stop(a)},doStop:function(t){var r,e,n,a=this,o=a._propsData;if(u.stop(a),t)for(r in o)n=o[r],e=n.fx,e&&e.frame(1)},doStart:function(){u.start(this)}}),n.Easing=s,n.Fx=l,n.version="1.0.0",n._name_="TimerAnim",o.mix(n,i.Statics),e.exports=n}),modulex.add("anim/timer/easing",[],function(t,r,e){function n(t){return t}function a(t,r,e,n){function a(t){return(3*l*t+2*c)*t+f}function o(t){return((l*t+c)*t+f)*t}function i(t){return((p*t+h)*t+v)*t}function s(t){for(var r,e,n=t,i=0;8>i;i++){if(e=o(n)-t,d(e)<m)return n;if(r=a(n),d(r)<m)break;n-=e/r}var s=1,u=0;for(n=t;s>u;){if(e=o(n)-t,d(e)<m)return n;e>0?s=n:u=n,n=(s+u)/2}return n}function u(t){return i(s(t))}var l=3*t-3*e+1,c=3*e-6*t,f=3*t,p=3*r-3*n+1,h=3*n-6*r,v=3*r;return u}var o=Math.PI,i=Math.pow,s=Math.sin,u=parseFloat,l=/^cubic-bezier\(([^,]+),([^,]+),([^,]+),([^,]+)\)$/i,c=1.70158,f={swing:function(t){return.5-Math.cos(t*o)/2},easeNone:n,linear:n,easeIn:function(t){return t*t},ease:a(.25,.1,.25,1),"ease-in":a(.42,0,1,1),"ease-out":a(0,0,.58,1),"ease-in-out":a(.42,0,.58,1),"ease-out-in":a(0,.42,1,.58),toFn:function(t){var r;return(r=t.match(l))?a(u(r[1]),u(r[2]),u(r[3]),u(r[4])):f[t]||n},easeOut:function(t){return(2-t)*t},easeBoth:function(t){return(t*=2)<1?.5*t*t:.5*(1- --t*(t-2))},easeInStrong:function(t){return t*t*t*t},easeOutStrong:function(t){return 1- --t*t*t*t},easeBothStrong:function(t){return(t*=2)<1?.5*t*t*t*t:.5*(2-(t-=2)*t*t*t)},elasticIn:function(t){var r=.3,e=r/4;return 0===t||1===t?t:0-i(2,10*(t-=1))*s(2*(t-e)*o/r)},elasticOut:function(t){var r=.3,e=r/4;return 0===t||1===t?t:i(2,-10*t)*s(2*(t-e)*o/r)+1},elasticBoth:function(t){var r=.45,e=r/4;return 0===t||2===(t*=2)?t:1>t?-.5*i(2,10*(t-=1))*s(2*(t-e)*o/r):i(2,-10*(t-=1))*s(2*(t-e)*o/r)*.5+1},backIn:function(t){return 1===t&&(t-=.001),t*t*((c+1)*t-c)},backOut:function(t){return(t-=1)*t*((c+1)*t+c)+1},backBoth:function(t){var r=c,e=(r*=1.525)+1;return(t*=2)<1?.5*t*t*(e*t-r):.5*((t-=2)*t*(e*t+r)+2)},bounceIn:function(t){return 1-f.bounceOut(1-t)},bounceOut:function(t){var r,e=7.5625;return r=1/2.75>t?e*t*t:2/2.75>t?e*(t-=1.5/2.75)*t+.75:2.5/2.75>t?e*(t-=2.25/2.75)*t+.9375:e*(t-=2.625/2.75)*t+.984375},bounceBoth:function(t){return.5>t?.5*f.bounceIn(2*t):.5*f.bounceOut(2*t-1)+.5}},m=1e-6,d=Math.abs;e.exports=f}),modulex.add("anim/timer/manager",[],function(t,r,e){var n,a,o=15;n=function(t){return setTimeout(t,o)},a=function(t){clearTimeout(t)};var i={head:null,tail:null},s=e.exports={runnings:i,timer:null,start:function(t){t._ksNext=t._ksPrev=null,i.head?(t._ksPrev=i.tail,i.tail._ksNext=t,i.tail=t):i.head=i.tail=t,s.startTimer()},stop:function(t){this.notRun(t)},notRun:function(t){t._ksPrev?(i.tail===t&&(i.tail=t._ksPrev),t._ksPrev._ksNext=t._ksNext,t._ksNext&&(t._ksNext._ksPrev=t._ksPrev)):(i.head=t._ksNext,i.tail===t&&(i.tail=i.head),i.head&&(i.head._ksPrev=null)),t._ksNext=t._ksPrev=null,i.head||s.stopTimer()},pause:function(t){this.notRun(t)},resume:function(t){this.start(t)},startTimer:function(){var t=this;t.timer||(t.timer=n(function r(){t.timer=n(r),t.runFrames()&&t.stopTimer()}))},stopTimer:function(){var t=this,r=t.timer;r&&(a(r),t.timer=0)},runFrames:function(){for(var t=i.head;t;){var r=t._ksNext;t.frame(),t=r}return!i.head}}}),modulex.add("anim/timer/fx",["util","dom"],function(t,r,e){function n(t,r){u.mix(t,r),t.pos=0,t.unit=t.unit||""}function a(t){n(this,t)}function o(t,r){var e;return t.style&&null!=t.style[r]||null==(e=l.attr(t,r,s,1))?null:e}function i(t,r){var e,n=u.now(),a=t.startTime,o=r.delay,i=r.duration;return e=n-a-o,0>=e?0:e>=i?1:r.easing(e/i)}var s,u=t("util"),l=t("dom"),c=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i;a.prototype={isCustomFx:0,constructor:a,load:function(t){n(this,t)},frame:function(t){if(1!==this.pos){var r=this,e=r.anim,n=r.prop,a=e.node,o=r.from,u=r.propData,c=r.to;if(t===s&&(t=i(e,u)),r.pos=t,o!==c&&0!==t){var f=r.interpolate(o,c,r.pos);r.val=f,u.frame?u.frame.call(r,e,r):r.isCustomFx||(f===s?(r.pos=1,f=c,console.warn("anim: "+n+"anim update directly ! : "+f+" : "+o+" : "+c)):f+=r.unit,r.val=f,"attr"===r.type?l.attr(a,n,f,1):l.css(a,n,f))}}},interpolate:function(t,r,e){return"number"==typeof t&&"number"==typeof r?Math.round(1e5*(t+(r-t)*e))/1e5:null},cur:function(){var t,r,e,n=this,a=n.prop,i=n.anim.node;if(n.isCustomFx)return i[a]||0;if((t=n.type)||(t=n.type=null!==(e=o(i,a))?"attr":"css"),"attr"===t)e=void 0===e?l.attr(i,a,s,1):e;else{e=l.style(i,a);var u=e.match(c);if(u){var f=u[3];f&&"px"!==f&&(e=l.css(i,a))}}return isNaN(r=parseFloat(e))?e&&"auto"!==e?e:0:r}},a.Factories={},a.FxTypes={},a.getFx=function(t){var r,e,n=a;return(r=t.fxType)?n=a.FxTypes[r]:!t.isCustomFx&&(e=a.Factories[t.prop])&&(n=e),new n(t)},e.exports=a}),modulex.add("anim/timer/color",["util","anim/timer/fx"],function(t,r,e){function n(t){t+="";var r;if(r=t.match(c))return[parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10)];if(r=t.match(f))return[parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10),parseInt(r[4],10)];if(r=t.match(m)){for(var e=1;e<r.length;e++)r[e].length<2&&(r[e]+=r[e]);return[parseInt(r[1],s),parseInt(r[2],s),parseInt(r[3],s)]}return l[t=t.toLowerCase()]?l[t]:(console.warn("anim: only allow rgb or hex color string : "+t),[255,255,255])}function a(){a.superclass.constructor.apply(this,arguments)}var o=t("util"),i=t("./fx"),s=16,u=Math.floor,l={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255]},c=/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,f=/^rgba\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+),\s*([0-9]+)\)$/i,m=/^#?([0-9A-F]{1,2})([0-9A-F]{1,2})([0-9A-F]{1,2})$/i,d=["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"];o.extend(a,i,{load:function(){var t=this;a.superclass.load.apply(t,arguments),t.from&&(t.from=n(t.from)),t.to&&(t.to=n(t.to))},interpolate:function(t,r,e){var n=a.superclass.interpolate;return 3===t.length&&3===r.length?"rgb("+[u(n(t[0],r[0],e)),u(n(t[1],r[1],e)),u(n(t[2],r[2],e))].join(", ")+")":4===t.length||4===r.length?"rgba("+[u(n(t[0],r[0],e)),u(n(t[1],r[1],e)),u(n(t[2],r[2],e)),u(n(t[3]||1,r[3]||1,e))].join(", ")+")":(console.warn("anim: unknown color value : "+t),void 0)}}),o.each(d,function(t){i.Factories[t]=a}),i.FxTypes.color=a,e.exports=a}),modulex.add("anim/timer/transform",["util","feature","dom","anim/timer/fx"],function(t,r,e){function n(t){return t=t.split(/,/),t=l.map(t,function(t){return i(t)})}function a(t){t=n(t);var r,e,a,o=t[0],s=t[1],u=t[2],l=t[3];return o*l-s*u?(r=Math.sqrt(o*o+s*s),a=(o*u+s*l)/(o*l-u*s),e=(o*l-s*u)/r,s*u>o*l&&(a=-a,r=-r)):r=e=a=0,{translateX:i(t[4]),translateY:i(t[5]),rotate:i(180*Math.atan2(s,o)/Math.PI),skewX:i(180*Math.atan(a)/Math.PI),skewY:0,scaleX:i(r),scaleY:i(e)}}function o(){return{translateX:0,translateY:0,rotate:0,skewX:0,skewY:0,scaleX:1,scaleY:1}}function i(t){return Math.round(1e5*parseFloat(t))/1e5}function s(t){t=t.split(")");for(var r,e,n,s=l.trim,u=-1,c=t.length-1,f=o();++u<c;)switch(r=t[u].split("("),e=s(r[0]),n=r[1],e){case"translateX":case"translateY":case"scaleX":case"scaleY":f[e]=i(n);break;case"rotate":case"skewX":case"skewY":var m=i(n);l.endsWith(n,"deg")||(m=180*m/Math.PI),f[e]=m;break;case"translate":case"translate3d":n=n.split(","),f.translateX=i(n[0]),f.translateY=i(n[1]||0);break;case"scale":n=n.split(","),f.scaleX=i(n[0]),f.scaleY=i(n[1]||n[0]);break;case"matrix":return a(n)}return f}function u(){u.superclass.constructor.apply(this,arguments)}var l=t("util"),c=t("feature"),f=t("dom"),m=t("./fx"),d=c.isTransform3dSupported()?"translate3d({translateX}px,{translateY}px,0)":"translate({translateX}px,{translateY}px)";l.extend(u,m,{load:function(){var t=this;u.superclass.load.apply(t,arguments),t.from=f.style(t.anim.node,"transform")||t.from,t.from=t.from&&"none"!==t.from?s(t.from):o(),t.to=t.to?s(t.to):o()},interpolate:function(t,r,e){var n=u.superclass.interpolate,a={};return a.translateX=n(t.translateX,r.translateX,e),a.translateY=n(t.translateY,r.translateY,e),a.rotate=n(t.rotate,r.rotate,e),a.skewX=n(t.skewX,r.skewX,e),a.skewY=n(t.skewY,r.skewY,e),a.scaleX=n(t.scaleX,r.scaleX,e),a.scaleY=n(t.scaleY,r.scaleY,e),l.substitute(d+" rotate({rotate}deg) skewX({skewX}deg) skewY({skewY}deg) scale({scaleX},{scaleY})",a)}}),m.Factories.transform=u,e.exports=u}),modulex.add("anim/timer/short-hand",[],function(t,r,e){e.exports={background:["backgroundColor"],border:["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor"],borderColor:["borderBottomColor","borderLeftColor","borderRightColor","borderTopColor"],borderBottom:["borderBottomWidth","borderBottomColor"],borderLeft:["borderLeftWidth","borderLeftColor"],borderTop:["borderTopWidth","borderTopColor"],borderRight:["borderRightWidth","borderRightColor"],font:["fontSize","fontWeight"],margin:["marginBottom","marginLeft","marginRight","marginTop"],padding:["paddingBottom","paddingLeft","paddingRight","paddingTop"]}});